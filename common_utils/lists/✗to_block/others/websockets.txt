
! WebSockets
! -----------
! REAL-TIME WEB TEST â€“ DOES HTML5 WEBSOCKETS WORK FOR YOU?
! https://websocketstest.com

! Advertising and Analytics (A&A) companies have used WebSockets
! to bypass ad blocking, exfiltrate user tracking data, and deliver advertisements.

! fix because of wss:// and ws://
! /^ws{1,2}(([\:][\/]{2})+)/
! /^wss?(([\:][\/]{2})+)/
! more generic
||*^$websocket


! somes allowing (if you want)
! -------------------------------------

! [FIX] streaming sites
@@||hlsplay.com^$websocket
@@||wss.jetload.net/cache$websocket,~third-party
hqq.tv#@%#//scriptlet("set-constant", "WebSocket", "undefined")

! [FIX] waaw, netu...
@@||commentsengine.com^$websocket,xmlhttprequest

! [FIX] P2P video delivery
@@||tracker.openwebtorrent.com^$websocket
@@||tracker.novage.com.ua^$websocket
@@wss://*tracker$websocket
@@||arc.io^$websocket

! [FIX] spotify
@@/?access_token=*$websocket,domain=spotify.com

! [FIX] utils
@@||lastpass.com^$websocket
! @@||chat.twitch.tv^$websocket
@@||chat.twitch.tv^$websocket
@@||packetlosstest.com^$websocket
@@||dns-oarc.net^$websocket
@@||*^$websocket,domain=discord.com

@@||edge-chat.*/chat$websocket,domain=facebook.com

! [FIX] short.ink, abysscdn.com, iamcdn.net players
@@||websocketgate.com^$websocket

! [FIX] speedtest
@@||nperf.net^$websocket
@@||cox.net^$websocket
@@||*^$websocket,domain=www.speedtest.net

! [FIX] dailymotion
@@*^$websocket,domain=geo.dailymotion.com

||*^$websocket,badfilter,domain=netflix.com
@@/ws{1,}[:]\/{2}/$domain=netflix.com

@@||forum.qt.io/socket.io/*$websocket
@@||wss.analyticacdn.com:8443^$websocket,domain=yandexcdn.com
@@||wss.analyticacdn.com^$websocket
@@||*^$websocket,domain=geoip.redirect-ads.com
||messaging.deezer.com/websocket$websocket,important

! ensure blocking
! -------------------------------------

/ws{2}\:\/\/net\-an{2}ounce(.*)/$websocket,important
wss://net-announce*^$websocket,important
||clearadnetwork.com^$websocket,important
||*.hostcontent.live^$websocket,important
||*.space:*^$websocket,important
||*.vidto*.*^$websocket,important
||alugha.com/graphql$websocket,important
||socket.tidio.co^$websocket,important
||*.private-api.com^$websocket,important
||*.idocdn.com^$websocket,important
||*^$websocket,_,~third-party,important,domain=deezer.com
