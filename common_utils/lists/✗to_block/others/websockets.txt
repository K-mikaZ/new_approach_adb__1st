
! WebSockets
! -----------
! REAL-TIME WEB TEST â€“ DOES HTML5 WEBSOCKETS WORK FOR YOU?
! https://websocketstest.com

! Advertising and Analytics (A&A) companies have used WebSockets
! to bypass ad blocking, exfiltrate user tracking data, and deliver advertisements.

! fix because of wss:// and ws://
! /^ws{1,2}(([\:][\/]{2})+)/
! /^wss?(([\:][\/]{2})+)/
! more generic
! ||*^$websocket


! somes allowing (if you want)
! -------------------------------------

! [FIX] streaming sites
@@$websocket,domain=hlsplay.com,important
@@||wss.jetload.net/cache$websocket,~third-party

! [FIX] waaw, netu...
hqq.tv#@%#//scriptlet("set-constant", "WebSocket", "undefined")
@@$websocket,xmlhttprequest,domain=commentsengine.com,important

! [FIX] P2P video delivery
@@$websocket,domain=tracker.openwebtorrent.com,important
@@$websocket,domain=tracker.novage.com.ua,important
@@$websocket,domain=arc.io,important
@@wss://*tracker$websocket

! [FIX] spotify
@@/?access_token=*$websocket,domain=spotify.com

! [FIX] utils
@@$websocket,domain=lastpass.com,important
@@$websocket,domain=chat.twitch.tv,important
@@$websocket,domain=packetlosstest.com,important
@@$websocket,domain=dns-oarc.net,important
@@$websocket,domain=discord.com,important

@@||edge-chat.*/chat$websocket,domain=facebook.com

! [FIX] short.ink, abysscdn.com, iamcdn.net players
@@||websocketgate.com^$websocket

! [FIX] speedtest
@@||nperf.net^$websocket
@@||cox.net^$websocket
@@$websocket,domain=www.speedtest.net

! [FIX] dailymotion
@@$websocket,domain=geo.dailymotion.com

||*^$websocket,badfilter,domain=netflix.com
@@/ws{1,}[:]\/{2}/$domain=netflix.com

@@||forum.qt.io/socket.io/*$websocket
@@||analyticacdn.com$websocket,important
@@||geoip.redirect-ads.com$websocket,important

! ensure blocking
! -------------------------------------

/ws{1,2}\:\/{2}net[-]an{2}ounce(.*)/$websocket,match-case,important
wss://net-announce*^$websocket,important
||*.space:*^$websocket,important
||*.vidto*.*^$websocket,important
||alugha.com/graphql$websocket,important
||clearadnetwork.com$websocket,important
||hostcontent.live$websocket,important
||socket.tidio.co$websocket,important
||private-api.com$websocket,important
||idocdn.com$websocket,important
$websocket,~third-party,domain=deezer.com,important
$websocket,~third-party,domain=tf1.fr,important
$websocket,domain=app.molotov.tv,redirect=empty,important
! websocket ads
$websocket,domain=pornhub.com|redtube.com|redtube.com.br|tube8.com|tube8.es|tube8.fr|xtube.com|youporn.com|youporngay.com
