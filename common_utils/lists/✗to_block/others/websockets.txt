
! WebSockets
! -----------
! REAL-TIME WEB TEST â€“ DOES HTML5 WEBSOCKETS WORK FOR YOU?
! https://websocketstest.com

! Advertising and Analytics (A&A) companies have used WebSockets
! to bypass ad blocking, exfiltrate user tracking data, and deliver advertisements.

! fix because of wss:// and ws://
! /^ws{1,2}((\:\/{2})+)/
! more generic
! ||*^$websocket


! somes allowing (if you want)
! -------------------------------------

! [FIX] streaming sites
@@$websocket,domain=hlsplay.com
@@||wss.jetload.net/cache$websocket,~third-party

! [FIX] waaw, netu...
hqq.tv#@#+js(set-constant, WebSocket, undefined)
@@$websocket,xmlhttprequest,domain=commentsengine.com

! [FIX] P2P video delivery
@@$websocket,domain=tracker.openwebtorrent.com
@@$websocket,domain=tracker.novage.com.ua
@@$websocket,domain=arc.io
@@wss://*tracker$websocket

! [FIX] spotify
@@/?access_token=*$websocket,domain=spotify.com

! [FIX] utils
@@$websocket,domain=lastpass.com
@@$websocket,domain=chat.twitch.tv
@@$websocket,domain=packetlosstest.com
@@$websocket,domain=dns-oarc.net
@@$websocket,domain=discord.com

@@||edge-chat.*/chat$websocket,domain=facebook.com

! [FIX] short.ink, abysscdn.com, iamcdn.net players
@@||websocketgate.com^$websocket

! [FIX] speedtest
@@||nperf.net^$websocket
@@||cox.net^$websocket
@@$websocket,domain=www.speedtest.net

! [FIX] dailymotion
@@$websocket,domain=geo.dailymotion.com

||*^$websocket,domain=netflix.com,badfilter
@@websocket,domain=netflix.com

@@websocket,domain=wolframalpha.com

! online torrent streaming with webtor.io
@@||api.nocturnal-narwhal.buzz^$websocket
@@$websocket,domain=webtor.io

@@||forum.qt.io/socket.io/*$websocket
@@||analyticacdn.com$websocket
@@||geoip.redirect-ads.com$websocket

! ensure blocking
! -------------------------------------

/^ws{1,2}\:\/{2}net[-]an{2}ounce(?:.+)/$websocket,important
wss://net-announce*$websocket,important
||*.space:*^$websocket,important
||*.vidto*.*^$websocket,important
||alugha.com/graphql$websocket,important
||clearadnetwork.com$websocket,important
||hostcontent.live$websocket,important
||socket.tidio.co$websocket,important
||private-api.com$websocket,important
||idocdn.com$websocket,important
$websocket,~third-party,important,domain=deezer.com
$websocket,~third-party,important,domain=tf1.fr
$websocket,important,redirect=empty,domain=app.molotov.tv
! websocket ads
$websocket,domain=pornhub.com|redtube.com|redtube.com.br|tube8.com|tube8.es|tube8.fr|xtube.com|youporn.com|youporngay.com
